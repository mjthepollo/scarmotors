{% extends "base.html" %}
{% load formset_tags %}
{% load custom_filters %}
{% load static %}
{% block css %}
{{block.super}}
<link rel="stylesheet" href="{% static 'css/demand/edit_register.css' %}">
{% endblock css %}
{% block content %}
<form id="formset" method="POST" data-formset-prefix="{{order_formset.prefix}}">
    {% csrf_token %}
    <h2>RO [{{register.RO_number}}]</h2>
    <div id="edit_special_register_form">
        {{edit_special_register_form.as_div}}
    </div>
    <div id="register_form">
        {{register_form.as_div}}
    </div>
    {{order_formset.management_form}}
    {{payment_formset.management_form}}
    {{charge_formset.management_form}}
    {{deposit_formset.management_form}}
    <h2>INFO</h2>
    <div id="order_edit_formset">
        {% for form in order_formset %}
        <div data-formset-form class="edit_order">
            <h3>주문</h3>
            {{order_formset|index_form:forloop.counter0}}
            <h3>출고</h3>
            {{payment_formset|index_form:forloop.counter0}}
            <h3>청구</h3>
            {{charge_formset|index_form:forloop.counter0}}
            <h3>입금</h3>
            {{deposit_formset|index_form:forloop.counter0}}
        </div>
        {% if not forloop.last%}
            <hr>
        {% endif %}
        {% endfor %}
    </div>
    <h2>추가주문</h2>
    <div data-formset-body id="order_formset">
    </div>
    <script type="form-template" data-formset-empty-form>
        {% escapescript %}
        <div data-formset-form class="new_order">
            {{order_formset.empty_form.as_div}}
        </div>
        {% endescapescript %}
    </script>
    <input id="add_button" type="button" class="btn btn-success" value="주문 추가하기" data-formset-add>
    <script>jQuery(function($) {
        $("#formset").formset({
            animateForms: true,
            reorderMode: 'dom',
        });
    });</script>
    <h2>비고</h2>
    <div id="register_note_form">
        {{register_note_form.note}}
    </div>
    <button id="complete" class="btn btn-dark">수정 완료</button>
</form>
{% endblock content %}
{% block footer%}
{% include "modules/footer.html" %}
{% endblock footer%}